# Это краткий гайд о том, как использовать Stripe для работы с моим приложением

## Что понадобится?

- Stripe CLI
- Зарегистрированный аккаунт Stripe
- Тестовый проект в Stripe

## Как получать колбеки в тестовом окружении?

Для полчения колбеков в тестовом окружении необходимо:

- Через Stripe CLI создать прослушивающий канал между удаленным сервером Stripe и локальной сетью, который будет перенаправлять данные на endpoint колбэков приложения.
Делается это с помощью команды 
```bash
stripe listen --forward-to http://localhost:9090/api/stripe/webhook
```
После запуска команды в консоль будет выведен временный ключ для колбэков, который надо скопировать и прописать в .env файле в переменную `STRIPE_WEBHOOK_SECRET_KEY`

После этих действий колбэки начнут доходить до приложения.

## Что должно быть в конфигурации?

В `.env` файле приложения должны быть:

- STRIPE_API_KEY - секретный ключ вашего тестового апи, через который будут запрашиваться данные с апи
- STRIPE_WEBHOOK_SECRET_KEY - ключ, который будет приходить вместе с колбэком, и проверяться на соответствие

## Полезные комманды

Триггер ивента успешной оплаты:

```bash
stripe trigger checkout.session.completed
```

## Полезные ссылки

- [Базовый адрес Stripe Dashboard](https://dashboard.stripe.com/test/dashboard)
- [Полная документация по API](https://docs.stripe.com/)
- [Online Stripe CLI](https://docs.stripe.com/stripe-cli)
- [Тестовые банковские карты](https://docs.stripe.com/testing)
- [Техническая документация Stripe API с описанием всех сущностей](https://github.com/stripe/stripe-java/)